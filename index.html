<!DOCTYPE html>
<html lang="pt-BR">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Atividade de Ci√™ncias - 4¬∫ Bimestre</title>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
            font-family: 'Segoe UI', Arial, sans-serif;
        }
        
        body {
            background-color: #e0f2e9;
            padding: 20px;
        }
        
        .container {
            max-width: 800px;
            margin: 0 auto;
            background-color: white;
            border-radius: 10px;
            box-shadow: 0 0 15px rgba(0, 0, 0, 0.15);
            overflow: hidden;
            padding: 2mm;
        }
        
        .header {
            background: linear-gradient(to right, #a8e6cf, #1a1a1a);
            padding: 20px;
            border-bottom: 2px solid #e0e0e0;
            color: white;
            text-shadow: 1px 1px 2px rgba(0, 0, 0, 0.5);
        }
        
        .school-name {
            text-align: center;
            font-weight: bold;
            font-size: 20px;
            margin-bottom: 15px;
            color: white;
        }
        
        .student-info {
            display: flex;
            flex-wrap: wrap;
            justify-content: space-between;
            gap: 10px;
        }
        
        .info-field {
            display: flex;
            align-items: center;
            margin-bottom: 10px;
        }
        
        .info-field label {
            margin-right: 5px;
            font-weight: bold;
            white-space: nowrap;
            color: white;
        }
        
        .info-field input, .info-field select {
            padding: 8px;
            border: 1px solid #ccc;
            border-radius: 4px;
            background-color: rgba(255, 255, 255, 0.9);
            transition: all 0.3s ease;
        }
        
        .info-field input:focus, .info-field select:focus {
            outline: none;
            box-shadow: 0 0 5px rgba(255, 255, 255, 0.5);
        }
        
        .name-field {
            width: 100%;
        }
        
        .number-field, .class-field, .date-field {
            flex: 1;
            min-width: 150px;
        }
        
        .activity-title {
            text-align: center;
            font-weight: bold;
            font-size: 22px;
            margin: 20px 0;
            color: #1a1a1a;
            text-shadow: 1px 1px 2px rgba(0, 0, 0, 0.1);
        }
        
        .question {
            background-color: #e6f7ff;
            margin: 3mm 0;
            padding: 15px;
            border-radius: 8px;
            box-shadow: 0 2px 6px rgba(0, 0, 0, 0.12);
            position: relative;
            transition: transform 0.3s ease;
        }
        
        .question:hover {
            transform: translateY(-2px);
        }
        
        .question-title {
            font-weight: bold;
            margin-bottom: 10px;
            font-size: 16px;
            color: #1a1a1a;
        }
        
        .question-image {
            max-width: 100%;
            height: auto;
            margin: 10px 0;
            border-radius: 5px;
            box-shadow: 0 2px 6px rgba(0, 0, 0, 0.15);
        }
        
        .options {
            margin-top: 15px;
        }
        
        .option {
            margin-bottom: 10px;
            padding: 12px;
            background-color: white;
            border-radius: 5px;
            border: 1px solid #ddd;
            cursor: pointer;
            transition: all 0.3s ease;
            font-weight: bold;
            position: relative;
            overflow: hidden;
        }
        
        .option:hover {
            background-color: #f0f8ff;
            transform: translateY(-2px);
            box-shadow: 0 4px 8px rgba(0, 0, 0, 0.1);
        }
        
        .option.selected {
            background-color: #003366;
            color: white;
            border-color: #002244;
            box-shadow: inset 0 4px 8px rgba(0, 0, 0, 0.3);
            transform: translateY(2px);
        }
        
        .option-image {
            max-width: 100%;
            height: auto;
            margin-top: 5px;
            border-radius: 3px;
        }
        
        .buttons {
            display: flex;
            justify-content: space-between;
            padding: 20px;
            background-color: #f8f9fa;
            border-top: 2px solid #e0e0e0;
        }
        
        button {
            padding: 12px 25px;
            border: none;
            border-radius: 5px;
            font-weight: bold;
            cursor: pointer;
            transition: all 0.3s ease;
            position: relative;
            overflow: hidden;
            box-shadow: 0 4px 8px rgba(0, 0, 0, 0.2);
        }
        
        button:active {
            transform: translateY(3px);
            box-shadow: 0 1px 3px rgba(0, 0, 0, 0.2);
        }
        
        #submitBtn {
            background-color: #28a745;
            color: white;
        }
        
        #submitBtn:hover {
            background-color: #218838;
        }
        
        #clearBtn {
            background-color: #dc3545;
            color: white;
        }
        
        #clearBtn:hover {
            background-color: #c82333;
        }
        
        .spacer {
            height: 3mm;
        }
        
        .ripple {
            position: absolute;
            border-radius: 50%;
            background-color: rgba(255, 255, 255, 0.7);
            transform: scale(0);
            animation: ripple 0.6s linear;
        }
        
        @keyframes ripple {
            to {
                transform: scale(4);
                opacity: 0;
            }
        }
        
        .hidden {
            display: none;
        }
    </style>
</head>
<body>
    <div class="container">
        <div class="header">
            <div class="school-name">E.E. PROF¬™ WANDA MASCAGNI DE S√Å</div>
            <div class="student-info">
                <div class="info-field name-field">
                    <label for="studentName">NOME:</label>
                    <select id="studentName" style="width: 100%;">
                        <option value="">Selecione seu nome</option>
                        <!-- Alunos do 7¬∫ Ano A -->
                        <option value="1" data-number="1" data-class="7¬∫ Ano A">ALICE CARDOSO DE ALCANTARA</option>
                        <option value="2" data-number="2" data-class="7¬∫ Ano A">ANA CAROLINA GONCALVES NASCIMENTO DE LIMA</option>
                        <option value="3" data-number="3" data-class="7¬∫ Ano A">ANA LUIZA VALENCA PAIVA</option>
                        <option value="5" data-number="5" data-class="7¬∫ Ano A">CARLOS EDUARDO MENEZES MACHADO</option>
                        <option value="7" data-number="7" data-class="7¬∫ Ano A">EVANDRO CUTOLO TEIXEIRA</option>
                        <option value="8" data-number="8" data-class="7¬∫ Ano A">GABRIELA SANTOS COSTA</option>
                        <option value="9" data-number="9" data-class="7¬∫ Ano A">GLEYSSON PEREIRA DOS SANTOS</option>
                        <option value="10" data-number="10" data-class="7¬∫ Ano A">GUILHERME CARMO RODRIGUES</option>
                        <option value="11" data-number="11" data-class="7¬∫ Ano A">GUSTAVO HENRIQUE DA SILVA</option>
                        <option value="12" data-number="12" data-class="7¬∫ Ano A">KELVIN DUARTE GONCALVES</option>
                        <option value="13" data-number="13" data-class="7¬∫ Ano A">KEVIN LELIS DA SILVA SIMAO</option>
                        <option value="14" data-number="14" data-class="7¬∫ Ano A">LAURA VITORIA ROCHA</option>
                        <option value="17" data-number="17" data-class="7¬∫ Ano A">LUCAS EDUARDO DA SILVA SANTANA</option>
                        <option value="21" data-number="21" data-class="7¬∫ Ano A">MIGUEL LIMA DE MESQUITA</option>
                        <option value="23" data-number="23" data-class="7¬∫ Ano A">NICOLAS ROCHA SILVA</option>
                        <option value="24" data-number="24" data-class="7¬∫ Ano A">PAOLLA MICHELLINE DOS SANTOS MARQUES</option>
                        <option value="25" data-number="25" data-class="7¬∫ Ano A">PEDRO HENRIQUE CORREA DE BRITO</option>
                        <option value="27" data-number="27" data-class="7¬∫ Ano A">RAFAEL CORREIA MENDES</option>
                        <option value="28" data-number="28" data-class="7¬∫ Ano A">RYAN GABRIEL PEREIRA DE SOUSA</option>
                        <option value="29" data-number="29" data-class="7¬∫ Ano A">SAMUEL ALVES DA COSTA</option>
                        <option value="30" data-number="30" data-class="7¬∫ Ano A">SOFIA AZEREDO CUBAS</option>
                        <option value="31" data-number="31" data-class="7¬∫ Ano A">SOPHIA LACERDA ANDRADE</option>
                        <option value="33" data-number="33" data-class="7¬∫ Ano A">THAYLLA DUANNY VENANCIO SCAQUITO</option>
                        <option value="34" data-number="34" data-class="7¬∫ Ano A">THAYS RODRIGUES DA SILVA</option>
                        <option value="35" data-number="35" data-class="7¬∫ Ano A">VICTOR HENRIQUE BENVINDO</option>
                        <option value="36" data-number="36" data-class="7¬∫ Ano A">FELIPE GONZALES PATRICIO ALVES</option>
                        <option value="37" data-number="37" data-class="7¬∫ Ano A">ISAAC FERNANDES DE ANDRADE</option>
                        <option value="39" data-number="39" data-class="7¬∫ Ano A">MIKAELLEN VIEIRA FERNANDES DOS SANTOS</option>
                        <option value="40" data-number="40" data-class="7¬∫ Ano A">BRYAN DINIZ SILVA</option>
                        <option value="41" data-number="41" data-class="7¬∫ Ano A">RAPHAEL MATHIAS NUNES MIRANDA</option>
                        <option value="42" data-number="42" data-class="7¬∫ Ano A">LEONARDO DE AVELAR CARVALHO</option>
                        <option value="44" data-number="44" data-class="7¬∫ Ano A">LETICIA CUSTODIO LIMA</option>
                        
                        <!-- Alunos do 7¬∫ Ano B (CORRIGIDOS) -->
                        <option value="1b" data-number="1" data-class="7¬∫ Ano B">ANGELLO GABRIEL CUTOLO TEIXEIRA</option>
                        <option value="2b" data-number="2" data-class="7¬∫ Ano B">ARTHUR HENRIQUE MARQUES ENDRES</option>
                        <option value="3b" data-number="3" data-class="7¬∫ Ano B">BIANCA CRISTINA DA SILVA SANTOS</option>
                        <option value="4b" data-number="4" data-class="7¬∫ Ano B">BRAYAN DA SILVA FERREIRA</option>
                        <option value="5b" data-number="5" data-class="7¬∫ Ano B">BRAYAN DUARTE DA SILVA</option>
                        <option value="6b" data-number="6" data-class="7¬∫ Ano B">BRUNO LUIZ NASCIMENTO DA SILVA</option>
                        <option value="7b" data-number="7" data-class="7¬∫ Ano B">DANIEL RODRIGUES SANTOS DIAS</option>
                        <option value="8b" data-number="8" data-class="7¬∫ Ano B">DIEGO BARRIO NOVO AMARAL DE ANDRADE</option>
                        <option value="10b" data-number="10" data-class="7¬∫ Ano B">FABRICIO LORENZO PARMA</option>
                        <option value="11b" data-number="11" data-class="7¬∫ Ano B">GABRIELA PAULINA FERREIRA MARTINS</option>
                        <option value="13b" data-number="13" data-class="7¬∫ Ano B">HYLLARY VICTORIA NERCIR DE FRAN√áA</option>
                        <option value="14b" data-number="14" data-class="7¬∫ Ano B">JHONAS KEYRRISON TROCATIS DA SILVA</option>
                        <option value="15b" data-number="15" data-class="7¬∫ Ano B">JULIA VITORIA SEVERA LINS</option>
                        <option value="17b" data-number="17" data-class="7¬∫ Ano B">KAMILLY VIT√ìRIA RODRIGUES DE SOUZA</option>
                        <option value="18b" data-number="18" data-class="7¬∫ Ano B">KESIA DOS SANTOS SOSTE</option>
                        <option value="19b" data-number="19" data-class="7¬∫ Ano B">LAURA BORGES AZEVEDO</option>
                        <option value="20b" data-number="20" data-class="7¬∫ Ano B">LUAN DANTAS NICOLUCCI</option>
                        <option value="21b" data-number="21" data-class="7¬∫ Ano B">LUAN RIBEIRO SILVA</option>
                        <option value="22b" data-number="22" data-class="7¬∫ Ano B">MANUELA ANGELICA TRIANA DA SILVA</option>
                        <option value="23b" data-number="23" data-class="7¬∫ Ano B">MARCELO GOMES THOMAZ</option>
                        <option value="24b" data-number="24" data-class="7¬∫ Ano B">MARCOS CELIO DE JESUS</option>
                        <option value="26b" data-number="26" data-class="7¬∫ Ano B">MARIA EDUARDA MACHADO DE LIMA</option>
                        <option value="28b" data-number="28" data-class="7¬∫ Ano B">NICOLLAS RODRIGUES TAVARES</option>
                        <option value="30b" data-number="30" data-class="7¬∫ Ano B">PAULO CESAR LAMBERT GON√áALVES</option>
                        <option value="33b" data-number="33" data-class="7¬∫ Ano B">VICTOR HUGO PRADO SANTOS DE BARROS</option>
                        <option value="34b" data-number="34" data-class="7¬∫ Ano B">WALLIF LEANDRO DE JESUS LESSA</option>
                        <option value="36b" data-number="36" data-class="7¬∫ Ano B">CRISTIANO MARQUES BATISTA DE SOUZA</option>
                        <option value="37b" data-number="37" data-class="7¬∫ Ano B">SOPHIA FRANCA DE CARVALHO</option>
                        <option value="39b" data-number="39" data-class="7¬∫ Ano B">FELIPE DE MEDEIROS OLIVEIRA</option>
                        <option value="40b" data-number="40" data-class="7¬∫ Ano B">PEDRO HENRIQUE OLIVEIRA GOMES</option>
                        <option value="41b" data-number="41" data-class="7¬∫ Ano B">PIETRO MARTINS NOBRE</option>
                        <option value="42b" data-number="42" data-class="7¬∫ Ano B">VINNICIUS RYAN CARDOSO PEREIRA DA SILVA</option>
                    </select>
                </div>
                <div class="info-field number-field">
                    <label for="studentNumber">N¬∫:</label>
                    <input type="text" id="studentNumber" readonly>
                </div>
                <div class="info-field class-field">
                    <label for="studentClass">S√âRIE:</label>
                    <input type="text" id="studentClass" readonly>
                </div>
                <div class="info-field date-field">
                    <label for="activityDate">DATA:</label>
                    <input type="date" id="activityDate">
                </div>
            </div>
        </div>
        
        <div class="spacer"></div>
        
        <div class="activity-title">ATIVIDADE DE CI√äNCIAS (4¬∫ BIMESTRE)</div>
        
        <!-- Quest√µes com respostas embaralhadas -->
        <div id="questions-container">
            <!-- As quest√µes ser√£o inseridas aqui dinamicamente -->
        </div>
        
        <div class="buttons">
            <button id="submitBtn">Enviar</button>
            <button id="clearBtn">Limpar</button>
        </div>
    </div>

    <!-- Template para as quest√µes (ser√° clonado e preenchido dinamicamente) -->
    <template id="question-template">
        <div class="question" data-question-id="">
            <div class="question-title"></div>
            <img src="" alt="" class="question-image">
            <div class="options">
                <!-- As op√ß√µes ser√£o inseridas aqui dinamicamente -->
            </div>
        </div>
    </template>

    <script>
        document.addEventListener('DOMContentLoaded', function() {
            const SCRIPT_URL = "https://script.google.com/macros/s/AKfycbw6hXxahoQHBeJMd2uxvREqzo0hhS6mE6zOt_0OB-zp1NQMHk5Ngh8wSRV0yCplwck/exec";
            
            // Array com as respostas corretas para cada quest√£o (antes do embaralhamento)
            const correctAnswers = [
                'B', // Quest√£o 1
                'B', // Quest√£o 2
                'B', // Quest√£o 3
                'B', // Quest√£o 4
                'B', // Quest√£o 5
                'B', // Quest√£o 6
                'B', // Quest√£o 7
                'B', // Quest√£o 8
                'B', // Quest√£o 9
                'B'  // Quest√£o 10
            ];
            
            // Array para armazenar as respostas corretas ap√≥s o embaralhamento
            let shuffledCorrectAnswers = [];
            
            // Dados das quest√µes
            const questionsData = [
                {
                    id: 1,
                    title: "1. Durante a pandemia de COVID-19, observamos diferentes fases de dissemina√ß√£o do v√≠rus. Analise o gr√°fico abaixo que representa a evolu√ß√£o de uma pandemia:",
                    image: "https://blogger.googleusercontent.com/img/b/R29vZ2xl/AVvXsEigCBSfGSmbRkKgK_lleY4DVc8Hcy_fke_L8W7_oXkc97eAnke6yGg7cGw61ZqpY3-b7JbbWYmup_Y4mPgv1WeIitYOblL_VvXYps6xCbrugFC2XJm0y5grS0zys3-MvRENnhB3w9Pqh9_Q1Wv88qpJyoKD2A-KF9gPY5RDMMxsDOxUTPtvhELbJz0Dlxzm/s720/Capturar.JPG",
                    options: [
                        { letter: "A", text: "O gr√°fico mostra que o n√∫mero de infectados permaneceu constante durante toda a pandemia, indicando medidas de controle eficazes desde o in√≠cio." },
                        { letter: "B", text: "Observa-se um pico de infectados seguido por uma diminui√ß√£o gradual, sugerindo que medidas de conten√ß√£o foram implementadas com sucesso ap√≥s o pico inicial." },
                        { letter: "C", text: "O n√∫mero de mortos √© sempre superior ao n√∫mero de infectados, o que indica uma taxa de letalidade extremamente alta para essa doen√ßa." },
                        { letter: "D", text: "A linha dos recuperados mostra que todas as pessoas infectadas se recuperaram rapidamente, sem necessidade de interven√ß√£o m√©dica especializada." }
                    ]
                },
                {
                    id: 2,
                    title: "2. As bact√©rias podem desenvolver resist√™ncia aos antibi√≥ticos atrav√©s de diferentes mecanismos. <br>Observe a imagem que representa o processo de sele√ß√£o de bact√©rias resistentes:",
                    image: "https://blogger.googleusercontent.com/img/b/R29vZ2xl/AVvXsEiBHTNgvu4FJCvK9U_9q4GXxh48fwm3vRjc7MwJnc4PW9VdB8fMucCXX28JlrTu7ELpAvNh-Rj8FnD9X_ZfI9tamkdU-HjoGNbMHyWv1kNh9SumEX_668r7Ts1emdJ_aEf7FRCBpPxqncRNWIY9oNI020pMSB3PJKtkdlPL33O3Bm1NliRhgn71eqQON-cr/s550/images%20%281%29.jpeg",
                    options: [
                        { letter: "A", text: "A resist√™ncia bacteriana ocorre apenas quando os antibi√≥ticos s√£o usados em doses muito altas, nunca em tratamentos com doses normais." },
                        { letter: "B", text: "As bact√©rias desenvolvem resist√™ncia atrav√©s de muta√ß√µes gen√©ticas que s√£o selecionadas pelo uso inadequado de antibi√≥ticos, permitindo que apenas as resistentes sobrevivem e se multipliquem." },
                        { letter: "C", text: "A imagem mostra que todas as bact√©rias s√£o igualmente sens√≠veis aos antibi√≥ticos, n√£o havendo varia√ß√£o na resist√™ncia entre diferentes linhagens." },
                        { letter: "D", text: "O desenvolvimento de resist√™ncia ocorre apenas em ambientes hospitalares, nunca em comunidades ou no meio ambiente." }
                    ]
                },
                {
                    id: 3,
                    title: "3. O sistema imunol√≥gico humano possui diferentes linhas de defesa contra pat√≥genos. Analise a imagem que representa a fagocitose por um gl√≥bulo branco:",
                    image: "https://blogger.googleusercontent.com/img/b/R29vZ2xl/AVvXsEj_DjZ4z8ZujJuw1fRSWYWBQGWv0aBKam2cjSBnVmWzF-XuTY-V8lJtOAd9u5ZD8V809tfwS8yt5kYqnfff60lW0nSqiXV40Q8Oh-0TMhtSMpx8ZXUgziUIhOfqcY44cqlemGRyls_tHc4Mh_vmeQdKPo9_YF8p2HkJfYkrmlhi4Ltvi9Cq2HDYLBG3qqxF/s903/Capturar.JPG",
                    options: [
                        { letter: "A", text: "A fagocitose √© um processo exclusivo da imunidade adaptativa, que s√≥ ocorre ap√≥s a exposi√ß√£o pr√©via a um pat√≥geno espec√≠fico." },
                        { letter: "B", text: "Este processo faz parte da imunidade inata, onde c√©lulas como macr√≥fagos e neutr√≥filos englobam e destroem microrganismos invasores de forma n√£o espec√≠fica." },
                        { letter: "C", text: "A imagem mostra a produ√ß√£o de anticorpos por linf√≥citos B, que √© o principal mecanismo de defesa contra todos os tipos de infec√ß√µes." },
                        { letter: "D", text: "A fagocitose √© um processo que s√≥ ocorre em resposta a infec√ß√µes virais, sendo ineficaz contra bact√©rias e fungos." }
                    ]
                },
                {
                    id: 4,
                    title: "4. As vacinas s√£o uma das interven√ß√µes de sa√∫de p√∫blica mais eficazes na preven√ß√£o de doen√ßas. Observe a imagem que representa o conceito de imunidade de rebanho:",
                    image: "https://blogger.googleusercontent.com/img/b/R29vZ2xl/AVvXsEh0Kpc6-UcyP36heAGOFU83hzCKxy7-eL3PVvdeuzzQuLxB3VkCXcqp3b6HxOzyuZRhor6x_IBAg820z0CxI6UGkvylxho8KBk4NdiDf9Qf9FLtaR8Ntz2GXIHGYiBizMuG1NhDmC7DCaFjLvlNEu3ofeGS9hKCCI1RbOSK8e-eRVR4YpeadHHgVnq0D0jx/s476/Capturar.JPG",
                    options: [
                        { letter: "A", text: "A imunidade de rebanho ocorre quando apenas 10% da popula√ß√£o est√° vacinada, protegendo assim toda a comunidade contra doen√ßas infecciosas." },
                        { letter: "B", text: "Este conceito se baseia na ideia de que quando uma alta porcentagem da popula√ß√£o est√° imune a uma doen√ßa, a transmiss√£o √© dificultada, protegendo tamb√©m indiv√≠duos n√£o vacinados." },
                        { letter: "C", text: "A imagem mostra que a vacina√ß√£o individual √© suficiente para proteger toda a popula√ß√£o, sem necessidade de altas coberturas vacinais." },
                        { letter: "D", text: "A imunidade de rebanho s√≥ √© eficaz contra doen√ßas bacterianas, n√£o tendo qualquer efeito sobre doen√ßas virais como COVID-19 ou sarampo." }
                    ]
                },
                {
                    id: 5,
                    title: "5. A tuberculose √© uma doen√ßa infecciosa causada pela bact√©ria Mycobacterium tuberculosis. Observe a imagem que mostra os principais sintomas da tuberculose:",
                    image: "https://blogger.googleusercontent.com/img/b/R29vZ2xl/AVvXsEiVCM0SKp4KgfqvNMPFngwhRB3C4Bt9fojM5wqNsBW2xjZV5mDU2TZURQJKil9j2NtZAwP_aPnOi312l-wRiXVHWizzTC6eCNRiaKfFPymsycwLL-PPm6tYCRMrC8T_Sa2i1f5zNSo3zY9Aft609z0K71wmLJjONpi8yqe_J5JVG8Lwhu7RfnfobET9LsGf/s450/Capturar.JPG",
                    options: [
                        { letter: "A", text: "A tuberculose √© uma doen√ßa que afeta apenas o sistema digestivo, causando principalmente diarreia e dor abdominal." },
                        { letter: "B", text: "Os principais sintomas incluem tosse persistente por mais de tr√™s semanas, febre vespertina, sudorese noturna e emagrecimento." },
                        { letter: "C", text: "A imagem mostra que a tuberculose √© uma doen√ßa que n√£o apresenta sintomas espec√≠ficos, sendo imposs√≠vel diagnostic√°-la clinicamente." },
                        { letter: "D", text: "A tuberculose √© uma doen√ßa autoimune que n√£o responde a tratamentos com antibi√≥ticos, exigindo apenas repouso para recupera√ß√£o." }
                    ]
                },
                {
                    id: 6,
                    title: "6. O sistema linf√°tico desempenha um papel fundamental na defesa do organismo. Analise a imagem que mostra a anatomia dos principais √≥rg√£os linfoides:",
                    image: "https://blogger.googleusercontent.com/img/b/R29vZ2xl/AVvXsEiZceAqxAfcxTk0w29-YoDh7HWb-AS5rJyMBGwjhDJoniH4MKs2gbmfrIVvtpUX024Oi8MVjnNcBIlXisiOwFtdJtDkGsLFGRQA9NeRejwSBJPBOL3hkbRcu3iKY5ERYTKb82Vwtbnm5PcgHNtFPRSkpSzlHFS3RDdOsIVV8Ezfw4vWH6XXYVCXp3_RiaEB/s450/Capturar.JPG",
                    options: [
                        { letter: "A", text: "O sistema linf√°tico √© respons√°vel apenas pelo transporte de nutrientes, n√£o tendo qualquer rela√ß√£o com a defesa imunol√≥gica do organismo." },
                        { letter: "B", text: "√ìrg√£os como ba√ßo, timo e linfonodos produzem e abrigam c√©lulas do sistema imune, sendo essenciais para a resposta imunol√≥gica contra pat√≥genos." },
                        { letter: "C", text: "A imagem mostra que o sistema linf√°tico √© independente do sistema circulat√≥rio, n√£o havendo comunica√ß√£o entre os dois sistemas." },
                        { letter: "D", text: "Os √≥rg√£os linfoides s√£o respons√°veis apenas pela produ√ß√£o de hem√°cias, n√£o participando da defesa contra infec√ß√µes." }
                    ]
                },
                {
                    id: 7,
                    title: "7. As ISTs (Infec√ß√µes Sexualmente Transmiss√≠veis) como gonorreia e clam√≠dia s√£o causadas por bact√©rias. Observe a imagem que representa a bact√©ria Neisseria gonorrhoeae:",
                    image: "https://blogger.googleusercontent.com/img/b/R29vZ2xl/AVvXsEhsObpZhcrMwbluG2Mae-ledhFut5Ih3nsTuyBtz15kAhk6-_Ez28nYzovNMDdcVup2lHYAD2M2hO_ikO0_HrUScqmS9LZejJYrz_4cvC4arvSb1Jx8fzh7s2eLHHR0ltd-2Yp9W6X_hyphenhyphenOPbkDwDJZ_6qXdBWyhdwgySvqZrT2Vy6TsKo0M3G7C67MqZHA5/s450/Capturar.JPG",
                    options: [
                        { letter: "A", text: "A gonorreia √© causada por um v√≠rus que n√£o responde a tratamentos com antibi√≥ticos, exigindo apenas repouso para recupera√ß√£o." },
                        { letter: "B", text: "Estas ISTs s√£o causadas por bact√©rias (Neisseria gonorrhoeae e Chlamydia trachomatis) que podem ser prevenidas pelo uso de preservativos e tratadas com antibi√≥ticos espec√≠ficos." },
                        { letter: "C", text: "A imagem mostra que a bact√©ria da gonorreia √© vis√≠vel a olho nu, facilitando seu diagn√≥stico sem necessidade de exames laboratoriais." },
                        { letter: "D", text: "As ISTs bacterianas afetam apenas o sistema respirat√≥rio, n√£o tendo qualquer rela√ß√£o com o sistema reprodutivo." }
                    ]
                },
                {
                    id: 8,
                    title: "8. O botulismo √© uma doen√ßa bacteriana grave causada pela toxina da Clostridium botulinum. Observe a imagem que mostra os alimentos que podem estar contaminados:",
                    image: "https://blogger.googleusercontent.com/img/b/R29vZ2xl/AVvXsEiso37jNZ_QZOFi4QA7NeRZl1xIEKXsOa-9LtKG8Ye4YqN__5KMpHTn_d9svRQn6J1beStdmbOWpHuQoC_PzxqQoCxoVhcOKQpPg616mnk8LPTHZQMZ53Y7LALxRpo98Emw08BI-trb6abxkw-Fn_FSxVe3_nTF3BP1csKs1zL95RL4tr0Ubpu2tN-polIh/s450/Capturar.JPG",
                    options: [
                        { letter: "A", text: "O botulismo √© uma infec√ß√£o viral que se espalha pelo ar, n√£o tendo rela√ß√£o com o consumo de alimentos contaminados." },
                        { letter: "B", text: "A doen√ßa √© causada pela toxina produzida pela bact√©ria Clostridium botulinum, que pode estar presente em alimentos enlatados ou conservas mal processadas." },
                        { letter: "C", text: "A imagem mostra que apenas alimentos frescos e n√£o processados podem conter a bact√©ria do botulismo." },
                        { letter: "D", text: "O botulismo √© uma doen√ßa contagiosa que se espalha facilmente de pessoa para pessoa, exigindo isolamento dos pacientes infectados." }
                    ]
                },
                {
                    id: 9,
                    title: "9. A resposta imune adaptativa envolve a produ√ß√£o de anticorpos espec√≠ficos. Analise a imagem que representa a intera√ß√£o entre ant√≠genos e anticorpos:",
                    image: "https://blogger.googleusercontent.com/img/b/R29vZ2xl/AVvXsEhDJZEFbCPgUEPru2yPrD2f2YGKa8U64u-p8M0pfatc3vrGS9f4ebOyMNGfrh9ulk7wnUOF6mvyYPcNdHoNEzyG6ajU9BEq3epp9wXHdOHDTAvwS37-dKS3u4ig8Lhx38MkgncpUaPfvRC_cSMCE60CxCC3uRQGo8JgbZcF778KgDLxDozVJ8uUJ12v48wg/s858/Capturar.JPG",
                    options: [
                        { letter: "A", text: "Os anticorpos s√£o produzidos por macr√≥fagos e atuam de forma n√£o espec√≠fica contra qualquer tipo de pat√≥geno." },
                        { letter: "B", text: "Os linf√≥citos B produzem anticorpos espec√≠ficos que se ligam a ant√≠genos espec√≠ficos, neutralizando os pat√≥genos e marcando-os para destrui√ß√£o." },
                        { letter: "C", text: "A imagem mostra que os anticorpos s√£o capazes de destruir diretamente as c√©lulas infectadas, sem necessidade de outras c√©lulas do sistema imune." },
                        { letter: "D", text: "Os anticorpos s√£o mol√©culas inespec√≠ficas que se ligam igualmente a todos os tipos de pat√≥genos, n√£o havendo especificidade na resposta imune." }
                    ]
                },
                {
                    id: 10,
                    title: "10. A produ√ß√£o de vacinas envolve v√°rias etapas rigorosas de controle de qualidade. Observe a imagem que representa o processo de fabrica√ß√£o de vacinas:",
                    image: "https://blogger.googleusercontent.com/img/b/R29vZ2xl/AVvXsEgJi2nDn5VFBbd8qZujERQUNs0WrIwQnTZ9Cl0Q3OLBi2VKd1L8IpGu_hXy8tuKjh7uLk4G1DabTkGTQ6EDFurU27Kf-5pRrc9AuW0YGy573rI6FjXqfkYp1qklR1kz9hXtRt1rIpDfQLkQVMCqso9R3EHd1Dy8yu-HALkxeaizcOWomDYOqgGyqT0uKCWN/s556/Capturar.JPG",
                    options: [
                        { letter: "A", text: "As vacinas s√£o produzidas de forma artesanal, sem necessidade de controle de qualidade ou aprova√ß√£o por ag√™ncias reguladoras." },
                        { letter: "B", text: "O processo inclui desenvolvimento do IFA (Ingrediente Farmac√™utico Ativo), testes cl√≠nicos, aprova√ß√£o pela Anvisa e produ√ß√£o em larga escala, com rigoroso controle de qualidade em todas as etapas." },
                        { letter: "C", text: "A imagem mostra que as vacinas s√£o produzidas a partir de sangue humano, sem qualquer processamento ou purifica√ß√£o." },
                        { letter: "D", text: "As vacinas n√£o passam por testes em animais ou humanos antes de serem disponibilizadas para a popula√ß√£o, visando acelerar o processo de produ√ß√£o." }
                    ]
                }
            ];
            
            /* =====================================================
               üü¶ 1) DATA ATUAL PADR√ÉO
            ===================================================== */
            const today = new Date();
            const formattedDate = today.toISOString().split('T')[0];
            document.getElementById('activityDate').value = formattedDate;
            
            /* =====================================================
               üü¶ 2) EMBARALHAR E EXIBIR QUEST√ïES
            ===================================================== */
            function shuffleArray(array) {
                for (let i = array.length - 1; i > 0; i--) {
                    const j = Math.floor(Math.random() * (i + 1));
                    [array[i], array[j]] = [array[j], array[i]];
                }
                return array;
            }
            
            function renderQuestions() {
                const container = document.getElementById('questions-container');
                const template = document.getElementById('question-template');
                
                // Limpa o container
                container.innerHTML = '';
                
                // Para cada quest√£o
                questionsData.forEach((questionData, index) => {
                    // Clona o template
                    const questionElement = template.content.cloneNode(true).querySelector('.question');
                    questionElement.setAttribute('data-question-id', questionData.id);
                    
                    // Preenche o t√≠tulo e a imagem
                    questionElement.querySelector('.question-title').innerHTML = questionData.title;
                    const imgElement = questionElement.querySelector('.question-image');
                    imgElement.src = questionData.image;
                    imgElement.alt = `Imagem da quest√£o ${questionData.id}`;
                    
                    // Embaralha as op√ß√µes
                    const shuffledOptions = shuffleArray([...questionData.options]);
                    
                    // Determina qual letra √© a correta ap√≥s o embaralhamento
                    const originalCorrectAnswer = correctAnswers[index];
                    const correctOption = questionData.options.find(opt => opt.letter === originalCorrectAnswer);
                    const shuffledCorrectLetter = shuffledOptions.findIndex(opt => opt.text === correctOption.text);
                    shuffledCorrectAnswers[index] = String.fromCharCode(65 + shuffledCorrectLetter); // Converte √≠ndice para letra (A, B, C, D)
                    
                    // Adiciona as op√ß√µes embaralhadas
                    const optionsContainer = questionElement.querySelector('.options');
                    shuffledOptions.forEach((option, optionIndex) => {
                        const optionElement = document.createElement('div');
                        optionElement.className = 'option';
                        optionElement.setAttribute('data-value', String.fromCharCode(65 + optionIndex)); // A, B, C, D
                        optionElement.textContent = `${String.fromCharCode(65 + optionIndex)}) ${option.text}`;
                        optionsContainer.appendChild(optionElement);
                    });
                    
                    // Adiciona a quest√£o ao container
                    container.appendChild(questionElement);
                    
                    // Adiciona espa√ßamento entre quest√µes
                    if (index < questionsData.length - 1) {
                        const spacer = document.createElement('div');
                        spacer.className = 'spacer';
                        container.appendChild(spacer);
                    }
                });
            }
            
            // Renderiza as quest√µes ao carregar a p√°gina
            renderQuestions();
            
            /* =====================================================
               üü¶ 3) PREENCHER N¬∫ E TURMA AO SELECIONAR O ALUNO
            ===================================================== */
            document.getElementById('studentName').addEventListener('change', function() {
                const selectedOption = this.options[this.selectedIndex];
                document.getElementById('studentNumber').value = selectedOption.getAttribute('data-number') || '';
                document.getElementById('studentClass').value = selectedOption.getAttribute('data-class') || '';
            });

            /* =====================================================
               üü¶ 4) SELE√á√ÉO DAS QUEST√ïES
            ===================================================== */
            document.addEventListener('click', function(e) {
                if (e.target.classList.contains('option')) {
                    const parentQuestion = e.target.closest('.question');
                    parentQuestion.querySelectorAll('.option').forEach(opt => {
                        opt.classList.remove('selected');
                    });
                    
                    e.target.classList.add('selected');
                    
                    if (typeof playClickSound === 'function') {
                        playClickSound();
                    }
                }
            });

            /* =====================================================
               üü¶ 5) BOT√ÉO LIMPAR
            ===================================================== */
            document.getElementById('clearBtn').addEventListener('click', function(e) {
                if (typeof createRipple === 'function') {
                    createRipple(e);
                }
                if (typeof playClickSound === 'function') {
                    playClickSound();
                }
                
                document.querySelectorAll('.option').forEach(option => {
                    option.classList.remove('selected');
                });
            });

            /* =====================================================
               üü¶ 6) BOT√ÉO ENVIAR
            ===================================================== */
            document.getElementById('submitBtn').addEventListener('click', function(e) {
                if (typeof createRipple === 'function') {
                    createRipple(e);
                }
                if (typeof playClickSound === 'function') {
                    playClickSound();
                }

                const studentSelect = document.getElementById('studentName');
                const selectedOption = studentSelect.options[studentSelect.selectedIndex];
                const studentName = selectedOption.text.trim() === 'Selecione seu nome' ? '' : selectedOption.text.trim();
                const studentNumber = document.getElementById('studentNumber').value;
                const studentClass = document.getElementById('studentClass').value;
                const activityDate = document.getElementById('activityDate').value;

                // Valida√ß√£o do aluno
                if (studentName === '' || studentName === 'Selecione seu nome') {
                    alert('Por favor, selecione seu nome na lista.');
                    return;
                }

                // Coleta das respostas
                const answers = [];
                document.querySelectorAll('.question').forEach((question, index) => {
                    const selectedOption = question.querySelector('.option.selected');
                    answers.push(selectedOption ? selectedOption.getAttribute('data-value') : '');
                });

                // Verifica se todas foram respondidas
                if (answers.includes('')) {
                    alert('Por favor, responda todas as quest√µes antes de enviar.');
                    return;
                }

                // Calcula nota usando as respostas corretas ap√≥s embaralhamento
                const score = answers.filter((answer, index) => answer === shuffledCorrectAnswers[index]).length;

                // Envia ao Apps Script
                submitToGoogleSheets(studentName, studentNumber, studentClass, activityDate, answers, score);
            });

            /* =====================================================
               üü¶ 7) ENVIO PARA O GOOGLE SHEETS
            ===================================================== */
            function submitToGoogleSheets(studentName, studentNumber, studentClass, activityDate, answers, score) {
                const formData = new FormData();
                formData.append('studentName', studentName);
                formData.append('studentNumber', studentNumber);
                formData.append('studentClass', studentClass);
                formData.append('activityDate', activityDate);
                formData.append('score', score);
                
                // Adiciona as respostas individualmente (Q1, Q2, Q3...)
                answers.forEach((answer, index) => {
                    formData.append(`Q${index + 1}`, answer);
                });

                // Adiciona um timestamp para registro
                formData.append('timestamp', new Date().toISOString());

                fetch(SCRIPT_URL, {
                    method: "POST",
                    body: formData
                })
                .then(async response => {
                    const text = await response.text();

                    let json;
                    try {
                        json = JSON.parse(text);
                    } catch {
                        json = { status: "error", message: text || "Resposta inv√°lida do servidor." };
                    }

                    if (json.status === "success") {
                        alert('Respostas enviadas com sucesso! Sua pontua√ß√£o: ' + score + '/10');
                    } else {
                        alert("Erro ao enviar: " + json.message);
                        console.error("Erro:", json);
                    }
                })
                .catch(error => {
                    console.error("Erro no envio:", error);
                    alert("Erro ao enviar respostas. Verifique a conex√£o.");
                });
            }

            /* =====================================================
               üü¶ 8) FUN√á√ÉO PARA CRIAR EFEITO DE ONDA NOS BOT√ïES
            ===================================================== */
            function createRipple(event) {
                const button = event.currentTarget;
                const circle = document.createElement("span");
                const diameter = Math.max(button.clientWidth, button.clientHeight);
                const radius = diameter / 2;

                circle.style.width = circle.style.height = `${diameter}px`;
                circle.style.left = `${event.clientX - button.getBoundingClientRect().left - radius}px`;
                circle.style.top = `${event.clientY - button.getBoundingClientRect().top - radius}px`;
                circle.classList.add("ripple");

                const ripple = button.getElementsByClassName("ripple")[0];
                if (ripple) {
                    ripple.remove();
                }

                button.appendChild(circle);
            }

            /* =====================================================
               üü¶ 9) FUN√á√ÉO PARA REPRODUZIR SOM DE CLIQUE
            ===================================================== */
            function playClickSound() {
                const audioContext = new (window.AudioContext || window.webkitAudioContext)();
                const oscillator = audioContext.createOscillator();
                const gainNode = audioContext.createGain();
                
                oscillator.connect(gainNode);
                gainNode.connect(audioContext.destination);
                
                oscillator.type = 'sine';
                oscillator.frequency.value = 800;
                gainNode.gain.value = 0.1;
                
                oscillator.start();
                
                setTimeout(() => {
                    oscillator.stop();
                }, 100);
            }
        });
    </script>
</body>
</html>








